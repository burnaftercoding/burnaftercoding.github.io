<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Play with NEventStore &#8211; Burn after coding</title>
<meta name="description" content="Burn after coding">
<meta name="keywords" content="Event Sourcing, C#">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://burnaftercoding.com/images/abstract-11.jpg">

<meta name="twitter:title" content="Play with NEventStore">
<meta name="twitter:description" content="Burn after coding">
<meta name="twitter:creator" content="@anthyme">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Play with NEventStore">
<meta property="og:description" content="Burn after coding">
<meta property="og:url" content="http://burnaftercoding.com/post/play-with-neventstore/">
<meta property="og:site_name" content="Burn after coding">





<link rel="canonical" href="http://burnaftercoding.com/post/play-with-neventstore/">
<link href="http://burnaftercoding.com/feed.xml" type="application/atom+xml" rel="alternate" title="Burn after coding Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://burnaftercoding.com/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://burnaftercoding.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://burnaftercoding.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://burnaftercoding.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://burnaftercoding.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://burnaftercoding.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://burnaftercoding.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://burnaftercoding.com/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://burnaftercoding.com">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://burnaftercoding.com/images/avatar.jpg" alt="Anthyme Caillard photo" class="author-photo">
					<h4>Anthyme Caillard</h4>
					<p>Software craftsman Dotnet addict &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Agile fan</p>
				</li>
				<li><a href="http://burnaftercoding.com/about/">Learn More</a></li>
				
				<li>
					<a href="http://twitter.com/anthyme"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				
				
				
				<li>
					<a href="http://github.com/anthyme"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://burnaftercoding.com/posts/">All Posts</a></li>
				<li><a href="http://burnaftercoding.com/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  
  <div class="entry-image">
    <img src="http://burnaftercoding.com/images/abstract-11.jpg" alt="Play with NEventStore">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://burnaftercoding.com/post/play-with-neventstore/" rel="bookmark" title="Play with NEventStore">Play with NEventStore</a></h1>
        
        <h2>October 11, 2015</h2>
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <h1>Play with NEventStore</h1>

<p>Today I am going to play with the <a href="https://github.com/NEventStore/NEventStore">NEventStore</a> library and share some code and feelings about it.
Briefly it is a .Net library to store events and potentially implement the Event Sourcing pattern with almost any databases as a storage.</p>

<h2>Event Sourcing</h2>

<h3>What is Event Sourcing?</h3>

<p>Before talking about the usage of <a href="https://github.com/NEventStore/NEventStore">NEventStore</a>, let&#39;s explain the purpose the Event Sourcing.</p>

<p>Usually, applications tend to store and update only le last state of application subjects in order to directly get them back in only one aspect. 
But there are drawbacks to this technique of storing data.
Firstly you are losing application usage data like for example data added and then removed from a <a href="https://en.wikipedia.org/wiki/Domain_model">domain model</a> are simply lost as products added and removed from a basket.
Secondly application <a href="https://en.wikipedia.org/wiki/Domain_model">domain models</a> sometime have really complex structure and are hard to save with transactions in relational databases. </p>

<p>Event sourcing is an alternative technique of data storage by not storing actual state of <a href="https://en.wikipedia.org/wiki/Domain_model">domain models</a> but by storing every <a href="http://martinfowler.com/eaaDev/DomainEvent.html">domain events</a> that happen on the <a href="https://en.wikipedia.org/wiki/Domain_model">domain models</a>. 
The events are immutable in an <em>append only</em> mode. They are grouped by &quot;stream&quot; identified by a &quot;StreamId&quot; which is the identifier of the <a href="https://en.wikipedia.org/wiki/Domain_model">domain models</a> concerned by the events.</p>

<p>There are a lot of advantages to use this technique. 
You know everything that append to the <a href="https://en.wikipedia.org/wiki/Domain_model">domain models</a> so you can go back in time to use an old state of the <a href="https://en.wikipedia.org/wiki/Domain_model">domain model</a>. 
You have a &quot;free&quot; audit history of the <a href="https://en.wikipedia.org/wiki/Domain_model">domain models</a>. 
The immutability and chronology of the events give you an easy ways to duplicate and scale the database. 
The event sourcing is really well suited for polyglot data and CQRS, allowing you to create multiples types of databases like relational, graph, NoSQL, cache, etc. optimized for each purposes of your system. </p>

<h3>How to implement Event Sourcing?</h3>

<p>When you think about it, Event Sourcing is a pattern and can be implemented (with a little effort) in a lot of existing databases like the classic relational databases.</p>

<p>As the pattern gain in popularity, some of its fans want to create a dedicated database engine optimized for the <em>append only</em> and immutability of storing events. This is how the EventStore database emerged as the fully event oriented database.</p>

<p>So what about the <a href="https://github.com/NEventStore/NEventStore">NEventStore</a> library? It is a unified API that handle the majority of event sourcing scenarios using a lot of existing databases (more than 20). This API has the big advantage to be well and long thought by experimented developer and avoid beginner to make mistakes on the infrastructure stack as they start using Event Sourcing.
The second cool thing about <a href="https://github.com/NEventStore/NEventStore">NEventStore</a> vs specific databases like <a href="https://geteventstore.com/">EventStore</a> is that you keep the ability to use the existing tools for development, administration, host, backup, ETL, etc. for the database you choose. </p>

<h2>Let&#39;s play with NEventStore!</h2>

<p>Now I will show you some test code that run <a href="https://github.com/NEventStore/NEventStore">NEventStore</a>. For asserting result I use the Shouldly library that extend every object in order to test its state.</p>

<h3>Models</h3>

<p>I must introduce some models that will be part of the tests.</p>

<p>First the event class use in the tests.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">SomethingHappened</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="kt">string</span> <span class="n">something</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Something</span> <span class="p">=</span> <span class="n">something</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">Something</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Events need some headers to be stored so I create an Event<T> class that compose all the events.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">Event</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">Event</span><span class="p">(</span><span class="n">Guid</span> <span class="n">eventId</span><span class="p">,</span> <span class="n">Guid</span> <span class="n">streamId</span><span class="p">,</span> <span class="n">T</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">EventId</span> <span class="p">=</span> <span class="n">eventId</span><span class="p">;</span>
        <span class="n">StreamId</span> <span class="p">=</span> <span class="n">streamId</span><span class="p">;</span>
        <span class="n">Data</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">Guid</span> <span class="n">StreamId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="n">Guid</span> <span class="n">EventId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="n">T</span> <span class="n">Data</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>And for a more convenient API, I add a factory.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">Event</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">Event</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Create</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">Guid</span> <span class="n">streamId</span><span class="p">,</span> <span class="n">T</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Create</span><span class="p">(</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">(),</span> <span class="n">streamId</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">Event</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Create</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">Guid</span> <span class="n">eventId</span><span class="p">,</span> <span class="n">Guid</span> <span class="n">streamId</span><span class="p">,</span> <span class="n">T</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Event</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">eventId</span><span class="p">,</span> <span class="n">streamId</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3>In memory database</h3>

<p><a href="https://github.com/NEventStore/NEventStore">NEventStore</a> can connect to a lot of database but it can also create an in memory database. It is really pleasant for Testing!</p>

<h4>Configuration</h4>

<p>A setup is only on line of fluent code.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">static</span> <span class="n">IStoreEvents</span> <span class="nf">CreateMemoryConnection</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Wireup</span><span class="p">.</span><span class="nf">Init</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">UsingInMemoryPersistence</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">InitializeStorageEngine</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">Build</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>Pretty simple to setup !</p>

<h4>Add and retrieve an event</h4>

<p>Now let&#39;s see how to add and retrieve one event to our store.
First I create the store with the previous method.
Then I can open the stream with the OpenStream method of the store. You have to specify the stream identifier but also the min and max revision identifier. With a 0 I choose to let it start from 0.
After that I commit and close the first opening of the stream and reopen it again to see if the event is present.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">var</span> <span class="n">streamId</span> <span class="p">=</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">();</span>
<span class="n">var</span> <span class="n">event1</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data1"</span><span class="p">));</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">store</span> <span class="p">=</span> <span class="nf">CreateMemoryConnection</span><span class="p">())</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event1</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">stream</span><span class="p">.</span><span class="n">CommittedEvents</span><span class="p">.</span><span class="n">Count</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>It worked!</p>

<h4>Concurrency handling</h4>

<p>==</p>

<p>Now I test a classic case: 2 clients try to modify a domain model at the same time.
A correctly implemented Event Sourcing implementation use an optimistic locking technic and should raise an exception for the last one in order to avoid corruption.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">var</span> <span class="n">streamId</span> <span class="p">=</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">();</span>
<span class="n">var</span> <span class="n">event1</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data1"</span><span class="p">));</span>
<span class="n">var</span> <span class="n">event2</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data2"</span><span class="p">));</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">store</span> <span class="p">=</span> <span class="nf">CreateMemoryConnection</span><span class="p">())</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream2</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event1</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>

    <span class="n">stream2</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event2</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">Assert</span><span class="p">.</span><span class="n">Throws</span><span class="p">&lt;</span><span class="n">ConcurrencyException</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">stream2</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event2</span><span class="p">.</span><span class="n">EventId</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
<p>This case is handled too.</p>

<h3>Storing events in an SQL Server database</h3>

<h4>Configuration</h4>

<p>The setup for a real database is easy too, you can create your connection with few lines of code.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ConnectionString</span> <span class="p">=</span> 
        <span class="s">"Server=(localdb)\\MSSQLLocalDB;Initial catalog=NEventStore;Integrated Security=true;"</span><span class="p">;</span>
<span class="k">public</span> <span class="k">static</span> <span class="n">IStoreEvents</span> <span class="nf">CreateSqlConnection</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">var</span> <span class="n">config</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConfigurationConnectionFactory</span><span class="p">(</span>
        <span class="s">"NEventStorePoc"</span><span class="p">,</span> <span class="s">"system.data.sqlclient"</span><span class="p">,</span> <span class="n">ConnectionString</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">Wireup</span><span class="p">.</span><span class="nf">Init</span><span class="p">()</span>
        <span class="p">.</span><span class="nf">UsingSqlPersistence</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">WithDialect</span><span class="p">(</span><span class="k">new</span> <span class="nf">MsSqlDialect</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">InitializeStorageEngine</span><span class="p">()</span>
        <span class="p">.</span><span class="nf">Build</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>There are a lot of customizations available like data encryption, log, performance tracking, dispatching â€¦ </p>

<h4>Commits table</h4>

<p>With this configuration a Commits table will be automatically created at the first usage.</p>

<p><img src="https://dl.dropboxusercontent.com/u/44389563/blog/code/play-with-neventstore/commits.png" alt="Commits"></p>

<h4>Add and retrieve an event</h4>

<p>I put events in the SQL store connection and check if the table contains the event data.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">var</span> <span class="n">streamId</span> <span class="p">=</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">();</span>
<span class="n">var</span> <span class="n">event1</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data1"</span><span class="p">));</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">store</span> <span class="p">=</span> <span class="nf">CreateSqlConnection</span><span class="p">())</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event1</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlConnection</span><span class="p">(</span><span class="n">ConnectionString</span><span class="p">))</span>
    <span class="n">connection</span>
    <span class="p">.</span><span class="nf">Query</span><span class="p">(</span><span class="s">"select * from commits where streamIdOriginal = @streamId"</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">streamId</span> <span class="p">})</span>
    <span class="p">.</span><span class="nf">Count</span><span class="p">().</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">store</span> <span class="p">=</span> <span class="nf">CreateSqlConnection</span><span class="p">())</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">stream</span><span class="p">.</span><span class="n">CommittedEvents</span><span class="p">.</span><span class="n">Count</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h4>Concurrency handling</h4>

<p>Now I test the concurrency concerns as for the memory store.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">var</span> <span class="n">streamId</span> <span class="p">=</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">();</span>
<span class="n">var</span> <span class="n">event1</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data1"</span><span class="p">));</span>
<span class="n">var</span> <span class="n">event2</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data2"</span><span class="p">));</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">store</span> <span class="p">=</span> <span class="nf">CreateSqlConnection</span><span class="p">())</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream2</span> <span class="p">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event1</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>

    <span class="n">stream2</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event2</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">Assert</span><span class="p">.</span><span class="n">Throws</span><span class="p">&lt;</span><span class="n">ConcurrencyException</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">stream2</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event2</span><span class="p">.</span><span class="n">EventId</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
<p>Still working.</p>

<h4>Distributed concurrency handling</h4>

<p>But what about a scaled system? With multiples servers?
I will simulate this by creating 2 concurrent connections and create 2 different events on the streams.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">var</span> <span class="n">streamId</span> <span class="p">=</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">();</span>
<span class="n">var</span> <span class="n">event1</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data1"</span><span class="p">));</span>
<span class="n">var</span> <span class="n">event2</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data2"</span><span class="p">));</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">connection1</span> <span class="p">=</span> <span class="nf">CreateSqlConnection</span><span class="p">())</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">connection2</span> <span class="p">=</span> <span class="nf">CreateSqlConnection</span><span class="p">())</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">connection1</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream2</span> <span class="p">=</span> <span class="n">connection2</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event1</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>

    <span class="n">stream2</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event2</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
    <span class="n">Assert</span><span class="p">.</span><span class="n">Throws</span><span class="p">&lt;</span><span class="n">ConcurrencyException</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">stream2</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event2</span><span class="p">.</span><span class="n">EventId</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
<p>Still green in the unit test runner, the concurrency is handled at the database level.</p>

<h3>Handling Snapshots</h3>

<p>Event storing is working well but in the Event Sourcing there is also the Snapshot pattern to handle.
The principle of snapshots is simple. If you have too many events for a stream, the stream manipulation can be slow. So when you want to optimize a stream you can create a snapshot that is a state representation at a point in time, store it and when you want to load a stream, you only load the snapshot and the following events.</p>

<h4>Snapshot in the database</h4>

<p>The storage of the snapshot is really simple, it is a simple serialized payload stored in an auto created Snapshots table.</p>

<p><img src="https://dl.dropboxusercontent.com/u/44389563/blog/code/play-with-neventstore/snapshots.png" alt="Snapshots"></p>

<h4>Snapshot model</h4>

<p>You need a structure to store your snapshot. For this example as I do not have a <a href="https://en.wikipedia.org/wiki/Domain_model">domain model</a> so I will put an aggregate like logic for the application of events in the snapshot in order to create it.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">SomeSnapshot</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">SomeSnapshot</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="k">public</span> <span class="nf">SomeSnapshot</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">events</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="n">var</span> <span class="n">@event</span> <span class="k">in</span> <span class="n">events</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="nf">Apply</span><span class="p">((</span><span class="n">dynamic</span><span class="p">)</span><span class="n">@event</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">RuntimeBinderException</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//unhandled event, skip
</span>            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">ICollection</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">State</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>

    <span class="k">public</span> <span class="n">Guid</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="n">Version</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">SomethingHappened</span> <span class="n">@event</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">State</span> <span class="p">=</span> <span class="n">State</span><span class="p">.</span><span class="nf">Union</span><span class="p">(</span><span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="n">@event</span><span class="p">.</span><span class="n">Something</span> <span class="p">}).</span><span class="nf">ToList</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>To test snapshot I will first create 3 events on a stream and save them to the store.
Then I will create a snapshot at this point.
Il will then get back the snapshot an reopen the stream and add d 2 more events.
And again I will reopen the stream with the snapshot and I should get only the 2 last events from the stream</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">var</span> <span class="n">streamId</span> <span class="p">=</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">();</span>
<span class="n">var</span> <span class="n">event1</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data1"</span><span class="p">));</span>
<span class="n">var</span> <span class="n">event2</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data2"</span><span class="p">));</span>
<span class="n">var</span> <span class="n">event3</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data3"</span><span class="p">));</span>

<span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">connection1</span> <span class="p">=</span> <span class="nf">CreateSqlConnection</span><span class="p">())</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">connection1</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event2</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event3</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event1</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>

        <span class="n">var</span> <span class="n">snapshotData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SomeSnapshot</span><span class="p">(</span><span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="n">event1</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">event2</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">event3</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">var</span> <span class="n">snapshot</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Snapshot</span><span class="p">(</span><span class="n">stream</span><span class="p">.</span><span class="n">StreamId</span><span class="p">,</span> <span class="n">stream</span><span class="p">.</span><span class="n">StreamRevision</span><span class="p">,</span> <span class="n">snapshotData</span><span class="p">);</span>
        <span class="n">connection1</span><span class="p">.</span><span class="n">Advanced</span><span class="p">.</span><span class="nf">AddSnapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="p">);</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">());</span>
        <span class="n">stream</span><span class="p">.</span><span class="n">CommittedEvents</span><span class="p">.</span><span class="n">Count</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">var</span> <span class="n">snapshot2</span> <span class="p">=</span> <span class="n">connection1</span><span class="p">.</span><span class="n">Advanced</span><span class="p">.</span><span class="nf">GetSnapshot</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">);</span>
    <span class="p">((</span><span class="n">SomeSnapshot</span><span class="p">)</span><span class="n">snapshot2</span><span class="p">.</span><span class="n">Payload</span><span class="p">).</span><span class="n">State</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"data1"</span><span class="p">,</span> <span class="s">"data2"</span><span class="p">,</span> <span class="s">"data3"</span><span class="p">,</span> <span class="p">});</span>

    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">connection1</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">snapshot2</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">stream</span><span class="p">.</span><span class="n">CommittedEvents</span><span class="p">.</span><span class="n">Count</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>

        <span class="n">var</span> <span class="n">event4</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data4"</span><span class="p">));</span>
        <span class="n">var</span> <span class="n">event5</span> <span class="p">=</span> <span class="n">Event</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="k">new</span> <span class="nf">SomethingHappened</span><span class="p">(</span><span class="s">"data5"</span><span class="p">));</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event4</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">EventMessage</span> <span class="p">{</span> <span class="n">Body</span> <span class="p">=</span> <span class="n">event5</span><span class="p">.</span><span class="n">Data</span> <span class="p">});</span>
        <span class="n">stream</span><span class="p">.</span><span class="nf">CommitChanges</span><span class="p">(</span><span class="n">event4</span><span class="p">.</span><span class="n">EventId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">var</span> <span class="n">snapshot3</span> <span class="p">=</span> <span class="n">connection1</span><span class="p">.</span><span class="n">Advanced</span><span class="p">.</span><span class="nf">GetSnapshot</span><span class="p">(</span><span class="n">streamId</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">);</span>
    <span class="p">((</span><span class="n">SomeSnapshot</span><span class="p">)</span><span class="n">snapshot3</span><span class="p">.</span><span class="n">Payload</span><span class="p">).</span><span class="n">State</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"data1"</span><span class="p">,</span> <span class="s">"data2"</span><span class="p">,</span> <span class="s">"data3"</span><span class="p">,</span> <span class="p">});</span>

    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">connection1</span><span class="p">.</span><span class="nf">OpenStream</span><span class="p">(</span><span class="n">snapshot3</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">stream</span><span class="p">.</span><span class="n">CommittedEvents</span><span class="p">.</span><span class="n">Count</span><span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="m">2</span><span class="p">);</span>
        <span class="n">stream</span><span class="p">.</span><span class="n">CommittedEvents</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Body</span><span class="p">).</span><span class="n">OfType</span><span class="p">&lt;</span><span class="n">SomethingHappened</span><span class="p">&gt;().</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Something</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">ShouldBe</span><span class="p">(</span><span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"data4"</span><span class="p">,</span> <span class="s">"data5"</span> <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Conclusion</h2>

<p>Working with Event Sourcing can be tricky at first but as you can see <a href="https://github.com/NEventStore/NEventStore">NEventStore</a> is a really easy to use library and it can help you to start smoothly.
A memory storage is available in order to simplify testing with the same API.
You can handle the storage of event and snapshots with a lot of databases from the relational world or even the NoSQL world.</p>

<p>You can find the source code on my <a href="https://github.com/anthyme/NEventStoreTests/tree/master/NEventStorePoc">GitHub</a>.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://burnaftercoding.com/tags/#Event Sourcing" title="Pages tagged Event Sourcing" class="tag">Event Sourcing</a><a href="http://burnaftercoding.com/tags/#C#" title="Pages tagged C#" class="tag">C#</a></span>
        <span><a href="http://burnaftercoding.com/post/play-with-neventstore/" rel="bookmark" title="Play with NEventStore">Play with NEventStore</a> was published on <span class="entry-date date published updated"><time datetime="2015-10-11T01:00:00+01:00">October 11, 2015</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="http://burnaftercoding.com/about/" title="About Anthyme Caillard">Anthyme Caillard</a></span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://burnaftercoding.com/post/play-with-neventstore/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://burnaftercoding.com/post/play-with-neventstore/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://burnaftercoding.com/post/play-with-neventstore/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="http://burnaftercoding.com/post/why-xamarin-strategy-mobile/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://burnaftercoding.com/post/why-xamarin-strategy-mobile/" title="Pourquoi choisir Xamarin pour votre stratÃ©gie mobile">Pourquoi choisir Xamarin pour votre stratÃ©gie mobile</a></h3>
      <p>Pourquoi choisir Xamarin pour votre stratÃ©gie mobileIntroductionLe marchÃ© des applications mobiles se dÃ©veloppe Ã©normÃ©ment ces derniÃ¨res ...&hellip; <a href="http://burnaftercoding.com/post/why-xamarin-strategy-mobile/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="http://burnaftercoding.com/post/trello-gtd/" title="Organisez votre vie avec Trello et GTD">Organisez votre vie avec Trello et GTD</a></h4>
        <span>Published on March 18, 2015</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="http://burnaftercoding.com/post/software-craftsmanship-coding-dojo-techdays/" title="Software Craftsmanship et Coding Dojo aux Techdays 2015 !">Software Craftsmanship et Coding Dojo aux Techdays 2015 !</a></h4>
        <span>Published on March 07, 2015</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 Anthyme Caillard. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://burnaftercoding.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://burnaftercoding.com/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56800873-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'burnaftercoding'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
